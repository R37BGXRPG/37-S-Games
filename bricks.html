<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Bricks Game</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="theme.css">
    <style>
        .main-box {
            max-width: 700px;
            margin: 48px auto 0 auto;
            padding: 24px 8px 24px 8px;
        }
        .instructions ul {
            padding-left: 1.2em;
            font-size: 1.05em;
        }
        #gameCanvas {
            display: block;
            margin: 0 auto 18px auto;
            background: var(--main-bg);
            border-radius: 18px;
            box-shadow: 2px 2px 12px var(--box-shadow1), -2px -2px 12px var(--box-shadow2);
            width: 100%;
            max-width: 600px;
            height: auto;
            touch-action: none;
        }
        @media (max-width: 700px) {
            .main-box {
                max-width: 98vw;
                padding: 12px 2vw;
            }
            #gameCanvas {
                max-width: 98vw;
                height: 60vw;
                min-height: 220px;
            }
        }
        @media (max-width: 480px) {
            .main-box {
                padding: 6px 1vw;
            }
            #gameCanvas {
                height: 48vw;
                min-height: 140px;
            }
            .instructions ul {
                font-size: 0.98em;
            }
        }
    </style>
</head>
<body>
    <nav class="navbar">
        <a href="index.html" class="navbar-brand">37's Games</a>
        <a href="index.html">Home</a>
        <a href="about.html">About</a>
        <a href="games.html">Games</a>
        <a href="contact.html">Contacts</a>
        <a href="settings.html" class="navbar-settings" title="Theme Settings">
            <svg viewBox="0 0 24 24" width="22" height="22" style="vertical-align:middle;">
                <path fill="currentColor"
                    d="M12 15.5A3.5 3.5 0 1 0 12 8.5a3.5 3.5 0 0 0 0 7zm7.43-2.9l1.77-1.03a1 1 0 0 0 .37-1.36l-1.67-2.89a1 1 0 0 0-1.28-.46l-1.77 1.03a7.03 7.03 0 0 0-1.52-.88l-.27-1.97A1 1 0 0 0 13.5 4h-3a1 1 0 0 0-1 .85l-.27 1.97a7.03 7.03 0 0 0-1.52.88l-1.77-1.03a1 1 0 0 0-1.28.46l-1.67 2.89a1 1 0 0 0 .37 1.36l1.77 1.03c-.06.32-.1.65-.1.99s.04.67.1.99l-1.77 1.03a1 1 0 0 0-.37 1.36l1.67 2.89a1 1 0 0 0 1.28.46l1.77-1.03c.47.34.98.63 1.52.88l.27 1.97a1 1 0 0 0 1 .85h3a1 1 0 0 0 1-.85l.27-1.97c.54-.25 1.05-.54 1.52-.88l1.77 1.03a1 1 0 0 0 1.28-.46l1.67-2.89a1 1 0 0 0-.37-1.36l-1.77-1.03c.06-.32.1-.65.1-.99s-.04-.67-.1-.99z" />
            </svg>
        </a>
    </nav>
    <div class="main-box">
        <div class="settings-icon" onclick="location.href='bricksgamesettings.html'" title="Settings"
            style="position:absolute;top:18px;right:18px;width:38px;height:38px;background:var(--box-bg);border-radius:50%;box-shadow:2px 2px 8px var(--box-shadow1),-2px -2px 8px var(--box-shadow2);display:flex;align-items:center;justify-content:center;cursor:pointer;">
            <svg viewBox="0 0 24 24" style="width:22px;height:22px;fill:var(--score-color);">
                <path
                    d="M12 15.5A3.5 3.5 0 1 0 12 8.5a3.5 3.5 0 0 0 0 7zm7.43-2.9l1.77-1.03a1 1 0 0 0 .37-1.36l-1.67-2.89a1 1 0 0 0-1.28-.46l-1.77 1.03a7.03 7.03 0 0 0-1.52-.88l-.27-1.97A1 1 0 0 0 13.5 4h-3a1 1 0 0 0-1 .85l-.27 1.97a7.03 7.03 0 0 0-1.52.88l-1.77-1.03a1 1 0 0 0-1.28.46l-1.67 2.89a1 1 0 0 0 .37 1.36l1.77 1.03c-.06.32-.1.65-.1.99s.04.67.1.99l-1.77 1.03a1 1 0 0 0-.37 1.36l1.67 2.89a1 1 0 0 0 1.28.46l1.77-1.03c.47.34.98.63 1.52.88l.27 1.97a1 1 0 0 0 1 .85h3a1 1 0 0 0 1-.85l.27-1.97c.54-.25 1.05-.54 1.52-.88l1.77 1.03a1 1 0 0 0 1.28-.46l1.67-2.89a1 1 0 0 0-.37-1.36l-1.77-1.03c.06-.32.1-.65.1-.99s-.04-.67-.1-.99z" />
            </svg>
        </div>
        <h2>Bricks Game</h2>
        <div class="instructions">
            <b>How to play:</b>
            <ul>
                <li>Use <b>A</b> or <b>Left Arrow</b> to move left.</li>
                <li>Use <b>D</b> or <b>Right Arrow</b> to move right.</li>
                <li>Swipe left/right on the game to move the paddle (touch screens).</li>
                <li>Bricks colors change with theme.</li>
                <li>The game ends if your paddle size reaches the minimum.</li>
            </ul>
        </div>
        <canvas id="gameCanvas" width="600" height="400"></canvas>
        <a href="index.html" class="back-link">‚Üê Back to Home</a>
    </div>
    <script src="theme.js"></script>
    <script>
        window.themeScope = 'bricks';
        initTheme('bricks');
        function getTheme() {
            return localStorage.getItem('bricksTheme') || 'night';
        }
        function getBrickColors() {
            const theme = getTheme();
            if (theme === 'neon') {
                const accent = localStorage.getItem('bricksNeonAccent') || '#39ff14,#232b25';
                const [accentColor] = accent.split(',');
                return [accentColor, '#ff3c00'];
            }
            if (theme === 'purple') return ['#5f27cd', '#ff3c00'];
            if (theme === 'dark') return ['#f4f4f4', '#ff3c00'];
            if (theme === 'light') return ['#1976d2', '#ff3c00'];
            return ['#3fa9f5', '#eebbc3'];
        }
        // Bricks Game logic (same as before)
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const paddle = { w: 80, h: 16, x: 260, y: 370, speed: 8 };
        let paddleLengths = [paddle.h];
        let sizeIncrease = 5;
        let obstacles = [];
        let score = 0;
        let left = false, right = false;
        let gameSpeed = Number(localStorage.getItem('bricksSpeed')) || 4;

        function drawPaddle() {
            let y = paddle.y - paddleLengths[0];
            for (let i = 0; i < paddleLengths.length; i++) {
                ctx.fillStyle = "#eaffd0";
                ctx.fillRect(paddle.x, y, paddle.w, paddleLengths[i]);
                y -= paddleLengths[i];
            }
        }
        function createObstacle() {
            const [color1, color2] = getBrickColors();
            const color = Math.random() < 0.5 ? color1 : color2;
            obstacles.push({
                x: Math.random() * (canvas.width - 30),
                y: 0,
                w: 30,
                h: 20,
                color: color
            });
        }
        function drawObstacles() {
            for (const o of obstacles) {
                ctx.fillStyle = o.color;
                ctx.fillRect(o.x, o.y, o.w, o.h);
            }
        }
        function moveObstacles() {
            for (const o of obstacles) o.y += gameSpeed;
        }
        function checkCollision() {
            let y = paddle.y - paddleLengths[0];
            for (let i = 0; i < paddleLengths.length; i++) {
                const block = { x: paddle.x, y: y, w: paddle.w, h: paddleLengths[i] };
                for (let j = obstacles.length - 1; j >= 0; j--) {
                    const o = obstacles[j];
                    if (block.x < o.x + o.w && block.x + block.w > o.x &&
                        block.y < o.y + o.h && block.y + block.h > o.y) {
                        const [color1, color2] = getBrickColors();
                        if (o.color === color1) {
                            let last = paddleLengths[paddleLengths.length - 1];
                            paddleLengths.push(last + sizeIncrease);
                            score++;
                        } else {
                            if (paddleLengths.length > 1) {
                                paddleLengths.pop();
                                score--;
                            } else {
                                setTimeout(() => {
                                    alert("Game Over! Final Score: " + score);
                                    document.location.reload();
                                }, 100);
                            }
                        }
                        obstacles.splice(j, 1);
                    } else if (o.y > canvas.height) {
                        obstacles.splice(j, 1);
                    }
                }
                y -= paddleLengths[i];
            }
        }
        function drawScore() {
            ctx.font = "20px monospace";
            ctx.fillStyle = getComputedStyle(document.documentElement).getPropertyValue('--score-color');
            ctx.fillText("Score: " + score, 10, 30);
        }
        function draw() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            drawPaddle();
            drawObstacles();
            drawScore();
        }
        function update() {
            if (left && paddle.x > 0) paddle.x -= paddle.speed;
            if (right && paddle.x < canvas.width - paddle.w) paddle.x += paddle.speed;
            moveObstacles();
            checkCollision();
        }
        setInterval(() => {
            createObstacle();
        }, 600);
        function gameLoop() {
            gameSpeed = Number(localStorage.getItem('bricksSpeed')) || 4;
            update();
            draw();
            requestAnimationFrame(gameLoop);
        }
        document.addEventListener('keydown', e => {
            if (e.key === "a" || e.key === "A" || e.key === "ArrowLeft") left = true;
            if (e.key === "d" || e.key === "D" || e.key === "ArrowRight") right = true;
        });
        document.addEventListener('keyup', e => {
            if (e.key === "a" || e.key === "A" || e.key === "ArrowLeft") left = false;
            if (e.key === "d" || e.key === "D" || e.key === "ArrowRight") right = false;
        });
        gameLoop();
        // Touch controls for mobile/touch screens
        let touchStartX = null;

        canvas.addEventListener('touchstart', function (e) {
            if (e.touches.length === 1) {
                touchStartX = e.touches[0].clientX;
            }
        });

        canvas.addEventListener('touchmove', function (e) {
            if (touchStartX !== null && e.touches.length === 1) {
                const touchX = e.touches[0].clientX;
                const deltaX = touchX - touchStartX;
                // Move paddle proportionally to swipe distance
                paddle.x += deltaX;
                // Clamp paddle within canvas
                if (paddle.x < 0) paddle.x = 0;
                if (paddle.x > canvas.width - paddle.w) paddle.x = canvas.width - paddle.w;
                touchStartX = touchX;
                e.preventDefault();
            }
        });

        canvas.addEventListener('touchend', function (e) {
            touchStartX = null;
        });

        // Responsive canvas resize for mobile
        function resizeCanvas() {
            // Set canvas width to parent width, keep aspect ratio
            const parent = canvas.parentElement;
            let width = parent.offsetWidth - 16;
            if (width > 600) width = 600;
            let height = Math.round(width * 2 / 3);
            if (height < 140) height = 140;
            canvas.width = width;
            canvas.height = height;
            paddle.y = height - 30;
        }
        window.addEventListener('resize', resizeCanvas);
        resizeCanvas();
    </script>
</body>
</html>